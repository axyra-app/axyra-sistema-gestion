class AxyraThemeManager{constructor(){this.themes = [];this.currentTheme = 'light';this.customThemes = [];this.colorPalettes = [];this.fonts = [];this.isLoaded = false;this.init();}init(){console.log('🎨 Inicializando sistema de gestión de temas...');this.loadThemes();this.loadCustomThemes();this.setupDefaultThemes();this.setupColorPalettes();this.setupFonts();this.applyCurrentTheme();this.isLoaded = true;}loadThemes(){try{const stored = localStorage.getItem('axyra_themes');if(stored){this.themes = JSON.parse(stored);}}catch(error){console.warn('Error cargando temas:',error);}}loadCustomThemes(){try{const stored = localStorage.getItem('axyra_custom_themes');if(stored){this.customThemes = JSON.parse(stored);}}catch(error){console.warn('Error cargando temas personalizados:',error);}}saveThemes(){try{localStorage.setItem('axyra_themes',JSON.stringify(this.themes));}catch(error){console.error('Error guardando temas:',error);}}saveCustomThemes(){try{localStorage.setItem('axyra_custom_themes',JSON.stringify(this.customThemes));}catch(error){console.error('Error guardando temas personalizados:',error);}}setupDefaultThemes(){if(this.themes.length === 0){this.themes = [{id:'light',name:'Claro',description:'Tema claro por defecto',colors:{primary:'#3498db',secondary:'#2c3e50',accent:'#e74c3c',background:'#ffffff',surface:'#f8f9fa',text:'#2c3e50',textSecondary:'#6c757d',border:'#dee2e6',success:'#28a745',warning:'#ffc107',error:'#dc3545',info:'#17a2b8',},fonts:{primary:'Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif',secondary:'Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif',mono:'Monaco,"Cascadia Code","Roboto Mono",Consolas,"Courier New",monospace',},spacing:{xs:'4px',sm:'8px',md:'16px',lg:'24px',xl:'32px',xxl:'48px',},borderRadius:{sm:'4px',md:'8px',lg:'12px',xl:'16px',},shadows:{sm:'0 1px 3px rgba(0,0,0,0.12),0 1px 2px rgba(0,0,0,0.24)',md:'0 3px 6px rgba(0,0,0,0.16),0 3px 6px rgba(0,0,0,0.23)',lg:'0 10px 20px rgba(0,0,0,0.19),0 6px 6px rgba(0,0,0,0.23)',xl:'0 14px 28px rgba(0,0,0,0.25),0 10px 10px rgba(0,0,0,0.22)',},},{id:'dark',name:'Oscuro',description:'Tema oscuro para uso nocturno',colors:{primary:'#3498db',secondary:'#34495e',accent:'#e74c3c',background:'#1a1a1a',surface:'#2d2d2d',text:'#ffffff',textSecondary:'#b0b0b0',border:'#404040',success:'#28a745',warning:'#ffc107',error:'#dc3545',info:'#17a2b8',},fonts:{primary:'Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif',secondary:'Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif',mono:'Monaco,"Cascadia Code","Roboto Mono",Consolas,"Courier New",monospace',},spacing:{xs:'4px',sm:'8px',md:'16px',lg:'24px',xl:'32px',xxl:'48px',},borderRadius:{sm:'4px',md:'8px',lg:'12px',xl:'16px',},shadows:{sm:'0 1px 3px rgba(0,0,0,0.3),0 1px 2px rgba(0,0,0,0.4)',md:'0 3px 6px rgba(0,0,0,0.4),0 3px 6px rgba(0,0,0,0.5)',lg:'0 10px 20px rgba(0,0,0,0.5),0 6px 6px rgba(0,0,0,0.6)',xl:'0 14px 28px rgba(0,0,0,0.6),0 10px 10px rgba(0,0,0,0.7)',},},{id:'high-contrast',name:'Alto Contraste',description:'Tema de alto contraste para accesibilidad',colors:{primary:'#0000ff',secondary:'#000000',accent:'#ff0000',background:'#ffffff',surface:'#ffffff',text:'#000000',textSecondary:'#000000',border:'#000000',success:'#008000',warning:'#ffff00',error:'#ff0000',info:'#0000ff',},fonts:{primary:'Arial,sans-serif',secondary:'Arial,sans-serif',mono:'Courier New,monospace',},spacing:{xs:'4px',sm:'8px',md:'16px',lg:'24px',xl:'32px',xxl:'48px',},borderRadius:{sm:'0px',md:'0px',lg:'0px',xl:'0px',},shadows:{sm:'none',md:'none',lg:'none',xl:'none',},},];this.saveThemes();}}setupColorPalettes(){this.colorPalettes = [{id:'blue',name:'Azul',colors:{primary:'#3498db',secondary:'#2c3e50',accent:'#e74c3c',},},{id:'green',name:'Verde',colors:{primary:'#27ae60',secondary:'#2c3e50',accent:'#e74c3c',},},{id:'purple',name:'Morado',colors:{primary:'#9b59b6',secondary:'#2c3e50',accent:'#e74c3c',},},{id:'orange',name:'Naranja',colors:{primary:'#f39c12',secondary:'#2c3e50',accent:'#e74c3c',},},{id:'red',name:'Rojo',colors:{primary:'#e74c3c',secondary:'#2c3e50',accent:'#3498db',},},];}setupFonts(){this.fonts = [{id:'inter',name:'Inter',family:'Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif',category:'sans-serif',},{id:'roboto',name:'Roboto',family:'Roboto,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif',category:'sans-serif',},{id:'open-sans',name:'Open Sans',family:'"Open Sans",-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif',category:'sans-serif',},{id:'lato',name:'Lato',family:'Lato,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif',category:'sans-serif',},{id:'poppins',name:'Poppins',family:'Poppins,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif',category:'sans-serif',},{id:'source-serif',name:'Source Serif Pro',family:'"Source Serif Pro",Georgia,serif',category:'serif',},{id:'playfair',name:'Playfair Display',family:'"Playfair Display",Georgia,serif',category:'serif',},{id:'monaco',name:'Monaco',family:'Monaco,"Cascadia Code","Roboto Mono",Consolas,"Courier New",monospace',category:'monospace',},];}applyCurrentTheme(){const theme = this.getCurrentTheme();if(theme){this.applyTheme(theme);}}getCurrentTheme(){return(this.themes.find((t)=> t.id === this.currentTheme)|| this.customThemes.find((t)=> t.id === this.currentTheme));}applyTheme(theme){if(!theme)return;this.applyColors(theme.colors);this.applyFonts(theme.fonts);this.applySpacing(theme.spacing);this.applyBorderRadius(theme.borderRadius);this.applyShadows(theme.shadows);document.body.className = document.body.className.replace(/theme-\w+/g,'');document.body.classList.add(`theme-${theme.id}`);this.currentTheme = theme.id;localStorage.setItem('axyra_current_theme',theme.id);console.log('🎨 Tema aplicado:',theme.name);}applyColors(colors){const root = document.documentElement;Object.entries(colors).forEach(([key,value])=>{root.style.setProperty(`--color-${key}`,value);});}applyFonts(fonts){const root = document.documentElement;Object.entries(fonts).forEach(([key,value])=>{root.style.setProperty(`--font-${key}`,value);});}applySpacing(spacing){const root = document.documentElement;Object.entries(spacing).forEach(([key,value])=>{root.style.setProperty(`--spacing-${key}`,value);});}applyBorderRadius(borderRadius){const root = document.documentElement;Object.entries(borderRadius).forEach(([key,value])=>{root.style.setProperty(`--border-radius-${key}`,value);});}applyShadows(shadows){const root = document.documentElement;Object.entries(shadows).forEach(([key,value])=>{root.style.setProperty(`--shadow-${key}`,value);});}setTheme(themeId){const theme = this.themes.find((t)=> t.id === themeId)|| this.customThemes.find((t)=> t.id === themeId);if(theme){this.currentTheme = themeId;this.applyTheme(theme);document.dispatchEvent(new CustomEvent('themeChanged',{detail:{theme:themeId,themeData:theme},}));console.log('🎨 Tema cambiado a:',theme.name);}}createCustomTheme(themeData){const theme ={id:themeData.id || 'custom_' + Date.now()+ '_' + Math.random().toString(36).substr(2,9),name:themeData.name,description:themeData.description || '',colors:themeData.colors ||{},fonts:themeData.fonts ||{},spacing:themeData.spacing ||{},borderRadius:themeData.borderRadius ||{},shadows:themeData.shadows ||{},isCustom:true,createdAt:new Date().toISOString(),createdBy:this.getCurrentUser(),};this.customThemes.push(theme);this.saveCustomThemes();console.log('✅ Tema personalizado creado:',theme.name);return theme;}updateCustomTheme(themeId,updates){const themeIndex = this.customThemes.findIndex((t)=> t.id === themeId);if(themeIndex === -1){throw new Error('Tema personalizado no encontrado');}this.customThemes[themeIndex] ={...this.customThemes[themeIndex],...updates,updatedAt:new Date().toISOString(),};this.saveCustomThemes();if(this.currentTheme === themeId){this.applyTheme(this.customThemes[themeIndex]);}console.log('✅ Tema personalizado actualizado:',this.customThemes[themeIndex].name);return this.customThemes[themeIndex];}deleteCustomTheme(themeId){const themeIndex = this.customThemes.findIndex((t)=> t.id === themeId);if(themeIndex === -1){throw new Error('Tema personalizado no encontrado');}const theme = this.customThemes[themeIndex];this.customThemes.splice(themeIndex,1);this.saveCustomThemes();if(this.currentTheme === themeId){this.setTheme('light');}console.log('🗑️ Tema personalizado eliminado:',theme.name);return theme;}getThemes(){return [...this.themes,...this.customThemes];}getDefaultThemes(){return [...this.themes];}getCustomThemes(){return [...this.customThemes];}getColorPalettes(){return [...this.colorPalettes];}getFonts(){return [...this.fonts];}createThemeFromPalette(paletteId,baseThemeId = 'light'){const palette = this.colorPalettes.find((p)=> p.id === paletteId);const baseTheme = this.themes.find((t)=> t.id === baseThemeId);if(!palette || !baseTheme){throw new Error('Paleta o tema base no encontrado');}const theme ={...baseTheme,id:'custom_' + Date.now()+ '_' + Math.random().toString(36).substr(2,9),name:`${baseTheme.name}- ${palette.name}`,description:`Tema basado en ${baseTheme.name}con paleta ${palette.name}`,colors:{...baseTheme.colors,...palette.colors,},isCustom:true,createdAt:new Date().toISOString(),createdBy:this.getCurrentUser(),};this.customThemes.push(theme);this.saveCustomThemes();console.log('✅ Tema creado desde paleta:',theme.name);return theme;}exportTheme(themeId){const theme = this.getThemes().find((t)=> t.id === themeId);if(!theme){throw new Error('Tema no encontrado');}const dataStr = JSON.stringify(theme,null,2);const dataBlob = new Blob([dataStr],{type:'application/json'});const url = URL.createObjectURL(dataBlob);const link = document.createElement('a');link.href = url;link.download = `axyra-theme-${theme.name.replace(/\s+/g,'-').toLowerCase()}.json`;document.body.appendChild(link);link.click();document.body.removeChild(link);URL.revokeObjectURL(url);console.log('📤 Tema exportado:',theme.name);}importTheme(file){return new Promise((resolve,reject)=>{const reader = new FileReader();reader.onload =(event)=>{try{const theme = JSON.parse(event.target.result);if(!theme.name || !theme.colors){throw new Error('Formato de tema inválido');}const customTheme = this.createCustomTheme(theme);console.log('✅ Tema importado:',customTheme.name);resolve(customTheme);}catch(error){console.error('Error importando tema:',error);reject(error);}};reader.onerror =()=>{reject(new Error('Error leyendo archivo'));};reader.readAsText(file);});}getCurrentUser(){if(window.obtenerUsuarioActual){const user = window.obtenerUsuarioActual();return user ? user.id:'anonymous';}return 'anonymous';}getThemePreview(themeId){const theme = this.getThemes().find((t)=> t.id === themeId);if(!theme)return null;return{id:theme.id,name:theme.name,colors:theme.colors,fonts:theme.fonts,preview:this.generateThemePreview(theme),};}generateThemePreview(theme){const preview = document.createElement('div');preview.className = 'theme-preview';preview.innerHTML = ` <div class="preview-header" style="background:${theme.colors.primary};color:${theme.colors.text};"> <h3 style="font-family:${theme.fonts.primary};">${theme.name}</h3> </div> <div class="preview-content" style="background:${theme.colors.background};color:${theme.colors.text};"> <div class="preview-card" style="background:${theme.colors.surface};border:1px solid ${theme.colors.border};"> <h4 style="font-family:${theme.fonts.primary};">Título de ejemplo</h4> <p style="font-family:${theme.fonts.secondary};color:${theme.colors.textSecondary};">Texto de ejemplo con diferentes colores y fuentes.</p> <button style="background:${theme.colors.primary};color:${theme.colors.text};border:none;padding:8px 16px;border-radius:${theme.borderRadius?.md || '8px'};"> Botón de ejemplo </button> </div> </div> `;return preview.outerHTML;}getThemeStatistics(){const totalThemes = this.themes.length + this.customThemes.length;const customThemes = this.customThemes.length;const mostUsedTheme = this.getMostUsedTheme();return{total:totalThemes,default:this.themes.length,custom:customThemes,current:this.currentTheme,mostUsed:mostUsedTheme,};}getMostUsedTheme(){return this.currentTheme;}resetToDefaultTheme(){this.setTheme('light');console.log('🔄 Tema restablecido al por defecto');}createThemeEditor(){const editor = document.createElement('div');editor.id = 'theme-editor';editor.innerHTML = ` <div class="theme-editor-header"> <h3>🎨 Editor de Temas</h3> <button onclick="document.getElementById('theme-editor').remove()" class="btn-close">×</button> </div> <div class="theme-editor-content"> <div class="theme-editor-tabs"> <button class="tab-btn active" data-tab="colors">Colores</button> <button class="tab-btn" data-tab="fonts">Fuentes</button> <button class="tab-btn" data-tab="spacing">Espaciado</button> <button class="tab-btn" data-tab="preview">Vista previa</button> </div> <div class="theme-editor-body"> <div class="tab-content active" id="colors-tab"> ${this.renderColorEditor()}</div> <div class="tab-content" id="fonts-tab"> ${this.renderFontEditor()}</div> <div class="tab-content" id="spacing-tab"> ${this.renderSpacingEditor()}</div> <div class="tab-content" id="preview-tab"> ${this.renderPreviewEditor()}</div> </div> <div class="theme-editor-footer"> <button onclick="axyraThemeManager.saveCustomTheme()" class="btn btn-primary">Guardar Tema</button> <button onclick="axyraThemeManager.resetThemeEditor()" class="btn btn-secondary">Resetear</button> </div> </div> `;editor.style.cssText = ` position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:80%;height:80%;background:white;border:1px solid #ddd;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.15);z-index:10000;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;`;document.body.appendChild(editor);const tabButtons = editor.querySelectorAll('.tab-btn');const tabContents = editor.querySelectorAll('.tab-content');tabButtons.forEach((button)=>{button.addEventListener('click',()=>{const tabId = button.dataset.tab;tabButtons.forEach((btn)=> btn.classList.remove('active'));tabContents.forEach((content)=> content.classList.remove('active'));button.classList.add('active');document.getElementById(`${tabId}-tab`).classList.add('active');});});}renderColorEditor(){const currentTheme = this.getCurrentTheme();if(!currentTheme)return '';return Object.entries(currentTheme.colors).map(([key,value])=> ` <div class="color-input-group"> <label for="color-${key}">${key}</label> <input type="color" id="color-${key}" value="${value}" onchange="axyraThemeManager.updateThemeColor('${key}',this.value)"> </div> `).join('');}renderFontEditor(){const currentTheme = this.getCurrentTheme();if(!currentTheme)return '';return Object.entries(currentTheme.fonts).map(([key,value])=> ` <div class="font-input-group"> <label for="font-${key}">${key}</label> <select id="font-${key}" onchange="axyraThemeManager.updateThemeFont('${key}',this.value)"> ${this.fonts .map((font)=> ` <option value="${font.family}" ${value === font.family ? 'selected':''}>${font.name}</option> `).join('')}</select> </div> `).join('');}renderSpacingEditor(){const currentTheme = this.getCurrentTheme();if(!currentTheme)return '';return Object.entries(currentTheme.spacing).map(([key,value])=> ` <div class="spacing-input-group"> <label for="spacing-${key}">${key}</label> <input type="range" id="spacing-${key}" min="0" max="64" value="${parseInt(value)}" onchange="axyraThemeManager.updateThemeSpacing('${key}',this.value + 'px')"> <span>${value}</span> </div> `).join('');}renderPreviewEditor(){const currentTheme = this.getCurrentTheme();if(!currentTheme)return '';return this.generateThemePreview(currentTheme);}updateThemeColor(key,value){const currentTheme = this.getCurrentTheme();if(currentTheme){currentTheme.colors[key] = value;this.applyTheme(currentTheme);}}updateThemeFont(key,value){const currentTheme = this.getCurrentTheme();if(currentTheme){currentTheme.fonts[key] = value;this.applyTheme(currentTheme);}}updateThemeSpacing(key,value){const currentTheme = this.getCurrentTheme();if(currentTheme){currentTheme.spacing[key] = value;this.applyTheme(currentTheme);}}saveCustomTheme(){const currentTheme = this.getCurrentTheme();if(currentTheme){this.createCustomTheme(currentTheme);console.log('✅ Tema personalizado guardado');}}resetThemeEditor(){this.setTheme('light');console.log('🔄 Editor de temas resetado');}}let axyraThemeManager;document.addEventListener('DOMContentLoaded',()=>{axyraThemeManager = new AxyraThemeManager();window.axyraThemeManager = axyraThemeManager;});window.AxyraThemeManager = AxyraThemeManager;