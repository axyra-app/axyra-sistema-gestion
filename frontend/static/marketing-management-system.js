class AxyraMarketingManagementSystem{constructor(){this.campaigns = [];this.segments = [];this.automations = [];this.leads = [];this.contacts = [];this.emails = [];this.sms = [];this.socialMedia = [];this.analytics = [];this.events = [];this.templates = [];this.isInitialized = false;this.init();}init(){console.log('üì¢ Inicializando sistema de marketing...');this.loadCampaigns();this.loadSegments();this.loadAutomations();this.loadLeads();this.loadContacts();this.loadEmails();this.loadSMS();this.loadSocialMedia();this.loadAnalytics();this.loadEvents();this.loadTemplates();this.setupEventListeners();this.setupDefaultData();this.isInitialized = true;}loadCampaigns(){try{const stored = localStorage.getItem('axyra_marketing_campaigns');if(stored){this.campaigns = JSON.parse(stored);}}catch(error){console.warn('Error cargando campa√±as:',error);}}saveCampaigns(){try{localStorage.setItem('axyra_marketing_campaigns',JSON.stringify(this.campaigns));}catch(error){console.error('Error guardando campa√±as:',error);}}loadSegments(){try{const stored = localStorage.getItem('axyra_marketing_segments');if(stored){this.segments = JSON.parse(stored);}}catch(error){console.warn('Error cargando segmentos:',error);}}saveSegments(){try{localStorage.setItem('axyra_marketing_segments',JSON.stringify(this.segments));}catch(error){console.error('Error guardando segmentos:',error);}}loadAutomations(){try{const stored = localStorage.getItem('axyra_marketing_automations');if(stored){this.automations = JSON.parse(stored);}}catch(error){console.warn('Error cargando automatizaciones:',error);}}saveAutomations(){try{localStorage.setItem('axyra_marketing_automations',JSON.stringify(this.automations));}catch(error){console.error('Error guardando automatizaciones:',error);}}loadLeads(){try{const stored = localStorage.getItem('axyra_marketing_leads');if(stored){this.leads = JSON.parse(stored);}}catch(error){console.warn('Error cargando leads:',error);}}saveLeads(){try{localStorage.setItem('axyra_marketing_leads',JSON.stringify(this.leads));}catch(error){console.error('Error guardando leads:',error);}}loadContacts(){try{const stored = localStorage.getItem('axyra_marketing_contacts');if(stored){this.contacts = JSON.parse(stored);}}catch(error){console.warn('Error cargando contactos:',error);}}saveContacts(){try{localStorage.setItem('axyra_marketing_contacts',JSON.stringify(this.contacts));}catch(error){console.error('Error guardando contactos:',error);}}loadEmails(){try{const stored = localStorage.getItem('axyra_marketing_emails');if(stored){this.emails = JSON.parse(stored);}}catch(error){console.warn('Error cargando emails:',error);}}saveEmails(){try{localStorage.setItem('axyra_marketing_emails',JSON.stringify(this.emails));}catch(error){console.error('Error guardando emails:',error);}}loadSMS(){try{const stored = localStorage.getItem('axyra_marketing_sms');if(stored){this.sms = JSON.parse(stored);}}catch(error){console.warn('Error cargando SMS:',error);}}saveSMS(){try{localStorage.setItem('axyra_marketing_sms',JSON.stringify(this.sms));}catch(error){console.error('Error guardando SMS:',error);}}loadSocialMedia(){try{const stored = localStorage.getItem('axyra_marketing_social_media');if(stored){this.socialMedia = JSON.parse(stored);}}catch(error){console.warn('Error cargando redes sociales:',error);}}saveSocialMedia(){try{localStorage.setItem('axyra_marketing_social_media',JSON.stringify(this.socialMedia));}catch(error){console.error('Error guardando redes sociales:',error);}}loadAnalytics(){try{const stored = localStorage.getItem('axyra_marketing_analytics');if(stored){this.analytics = JSON.parse(stored);}}catch(error){console.warn('Error cargando analytics:',error);}}saveAnalytics(){try{localStorage.setItem('axyra_marketing_analytics',JSON.stringify(this.analytics));}catch(error){console.error('Error guardando analytics:',error);}}loadEvents(){try{const stored = localStorage.getItem('axyra_marketing_events');if(stored){this.events = JSON.parse(stored);}}catch(error){console.warn('Error cargando eventos:',error);}}saveEvents(){try{localStorage.setItem('axyra_marketing_events',JSON.stringify(this.events));}catch(error){console.error('Error guardando eventos:',error);}}loadTemplates(){try{const stored = localStorage.getItem('axyra_marketing_templates');if(stored){this.templates = JSON.parse(stored);}}catch(error){console.warn('Error cargando plantillas:',error);}}saveTemplates(){try{localStorage.setItem('axyra_marketing_templates',JSON.stringify(this.templates));}catch(error){console.error('Error guardando plantillas:',error);}}setupEventListeners(){document.addEventListener('campaignChanged',(event)=>{this.handleCampaignChange(event.detail);});document.addEventListener('leadChanged',(event)=>{this.handleLeadChange(event.detail);});}setupDefaultData(){if(this.templates.length === 0){this.templates = [{id:'email_welcome',name:'Email de Bienvenida',type:'email',subject:'¬°Bienvenido a nuestra empresa!',content:'Gracias por unirte a nosotros. Estamos emocionados de tenerte como parte de nuestra comunidad.',isActive:true,},{id:'email_promotion',name:'Email de Promoci√≥n',type:'email',subject:'¬°Oferta especial para ti!',content:'No te pierdas esta incre√≠ble oferta. Aprovecha ahora y ahorra hasta un 50%.',isActive:true,},{id:'sms_reminder',name:'SMS Recordatorio',type:'sms',content:'Recordatorio:Tienes una cita ma√±ana a las 10:00 AM. ¬°No olvides asistir!',isActive:true,},];this.saveTemplates();}}handleCampaignChange(change){const{campaignId,action,data}= change;switch(action){case 'created':this.campaigns.push(data);this.saveCampaigns();break;case 'updated':const campaignIndex = this.campaigns.findIndex((c)=> c.id === campaignId);if(campaignIndex !== -1){this.campaigns[campaignIndex] ={...this.campaigns[campaignIndex],...data};this.saveCampaigns();}break;case 'deleted':this.campaigns = this.campaigns.filter((c)=> c.id !== campaignId);this.saveCampaigns();break;}}handleLeadChange(change){const{leadId,action,data}= change;switch(action){case 'created':this.leads.push(data);this.saveLeads();break;case 'updated':const leadIndex = this.leads.findIndex((l)=> l.id === leadId);if(leadIndex !== -1){this.leads[leadIndex] ={...this.leads[leadIndex],...data};this.saveLeads();}break;case 'deleted':this.leads = this.leads.filter((l)=> l.id !== leadId);this.saveLeads();break;}}createCampaign(campaignData){const campaign ={id:'campaign_' + Date.now()+ '_' + Math.random().toString(36).substr(2,9),name:campaignData.name,description:campaignData.description || '',type:campaignData.type || 'email',status:campaignData.status || 'draft',startDate:campaignData.startDate,endDate:campaignData.endDate,budget:campaignData.budget || 0,targetAudience:campaignData.targetAudience || [],goals:campaignData.goals || [],metrics:campaignData.metrics ||{},content:campaignData.content || '',isActive:campaignData.isActive !== false,metadata:{createdAt:new Date().toISOString(),createdBy:this.getCurrentUser(),updatedAt:new Date().toISOString(),updatedBy:this.getCurrentUser(),},};this.campaigns.push(campaign);this.saveCampaigns();console.log('‚úÖ Campa√±a creada:',campaign.name);return campaign;}createSegment(segmentData){const segment ={id:'segment_' + Date.now()+ '_' + Math.random().toString(36).substr(2,9),name:segmentData.name,description:segmentData.description || '',criteria:segmentData.criteria || [],contactCount:segmentData.contactCount || 0,isActive:segmentData.isActive !== false,metadata:{createdAt:new Date().toISOString(),createdBy:this.getCurrentUser(),updatedAt:new Date().toISOString(),updatedBy:this.getCurrentUser(),},};this.segments.push(segment);this.saveSegments();console.log('‚úÖ Segmento creado:',segment.name);return segment;}createAutomation(automationData){const automation ={id:'automation_' + Date.now()+ '_' + Math.random().toString(36).substr(2,9),name:automationData.name,description:automationData.description || '',trigger:automationData.trigger ||{},actions:automationData.actions || [],conditions:automationData.conditions || [],isActive:automationData.isActive !== false,metadata:{createdAt:new Date().toISOString(),createdBy:this.getCurrentUser(),updatedAt:new Date().toISOString(),updatedBy:this.getCurrentUser(),},};this.automations.push(automation);this.saveAutomations();console.log('‚úÖ Automatizaci√≥n creada:',automation.name);return automation;}createLead(leadData){const lead ={id:'lead_' + Date.now()+ '_' + Math.random().toString(36).substr(2,9),firstName:leadData.firstName,lastName:leadData.lastName,email:leadData.email,phone:leadData.phone || '',company:leadData.company || '',position:leadData.position || '',source:leadData.source || 'website',status:leadData.status || 'new',score:leadData.score || 0,notes:leadData.notes || '',tags:leadData.tags || [],isActive:leadData.isActive !== false,metadata:{createdAt:new Date().toISOString(),createdBy:this.getCurrentUser(),updatedAt:new Date().toISOString(),updatedBy:this.getCurrentUser(),},};this.leads.push(lead);this.saveLeads();console.log('‚úÖ Lead creado:',lead.firstName + ' ' + lead.lastName);return lead;}createContact(contactData){const contact ={id:'contact_' + Date.now()+ '_' + Math.random().toString(36).substr(2,9),firstName:contactData.firstName,lastName:contactData.lastName,email:contactData.email,phone:contactData.phone || '',company:contactData.company || '',position:contactData.position || '',segmentIds:contactData.segmentIds || [],preferences:contactData.preferences ||{},isActive:contactData.isActive !== false,metadata:{createdAt:new Date().toISOString(),createdBy:this.getCurrentUser(),updatedAt:new Date().toISOString(),updatedBy:this.getCurrentUser(),},};this.contacts.push(contact);this.saveContacts();console.log('‚úÖ Contacto creado:',contact.firstName + ' ' + contact.lastName);return contact;}createEmail(emailData){const email ={id:'email_' + Date.now()+ '_' + Math.random().toString(36).substr(2,9),subject:emailData.subject,content:emailData.content,templateId:emailData.templateId || null,recipientIds:emailData.recipientIds || [],campaignId:emailData.campaignId || null,status:emailData.status || 'draft',scheduledAt:emailData.scheduledAt || null,sentAt:emailData.sentAt || null,openRate:emailData.openRate || 0,clickRate:emailData.clickRate || 0,metadata:{createdAt:new Date().toISOString(),createdBy:this.getCurrentUser(),updatedAt:new Date().toISOString(),updatedBy:this.getCurrentUser(),},};this.emails.push(email);this.saveEmails();console.log('‚úÖ Email creado:',email.subject);return email;}createSMS(smsData){const sms ={id:'sms_' + Date.now()+ '_' + Math.random().toString(36).substr(2,9),content:smsData.content,recipientIds:smsData.recipientIds || [],campaignId:smsData.campaignId || null,status:smsData.status || 'draft',scheduledAt:smsData.scheduledAt || null,sentAt:smsData.sentAt || null,deliveryRate:smsData.deliveryRate || 0,metadata:{createdAt:new Date().toISOString(),createdBy:this.getCurrentUser(),updatedAt:new Date().toISOString(),updatedBy:this.getCurrentUser(),},};this.sms.push(sms);this.saveSMS();console.log('‚úÖ SMS creado:',sms.content);return sms;}createSocialMediaPost(postData){const post ={id:'post_' + Date.now()+ '_' + Math.random().toString(36).substr(2,9),content:postData.content,platform:postData.platform,campaignId:postData.campaignId || null,status:postData.status || 'draft',scheduledAt:postData.scheduledAt || null,publishedAt:postData.publishedAt || null,engagement:postData.engagement ||{},metadata:{createdAt:new Date().toISOString(),createdBy:this.getCurrentUser(),updatedAt:new Date().toISOString(),updatedBy:this.getCurrentUser(),},};this.socialMedia.push(post);this.saveSocialMedia();console.log('‚úÖ Post de redes sociales creado:',post.content);return post;}createEvent(eventData){const event ={id:'event_' + Date.now()+ '_' + Math.random().toString(36).substr(2,9),name:eventData.name,description:eventData.description || '',type:eventData.type || 'webinar',startDate:eventData.startDate,endDate:eventData.endDate,location:eventData.location || '',capacity:eventData.capacity || 0,registered:eventData.registered || 0,status:eventData.status || 'planned',campaignId:eventData.campaignId || null,metadata:{createdAt:new Date().toISOString(),createdBy:this.getCurrentUser(),updatedAt:new Date().toISOString(),updatedBy:this.getCurrentUser(),},};this.events.push(event);this.saveEvents();console.log('‚úÖ Evento creado:',event.name);return event;}createTemplate(templateData){const template ={id:'template_' + Date.now()+ '_' + Math.random().toString(36).substr(2,9),name:templateData.name,type:templateData.type,subject:templateData.subject || '',content:templateData.content,variables:templateData.variables || [],isActive:templateData.isActive !== false,metadata:{createdAt:new Date().toISOString(),createdBy:this.getCurrentUser(),updatedAt:new Date().toISOString(),updatedBy:this.getCurrentUser(),},};this.templates.push(template);this.saveTemplates();console.log('‚úÖ Plantilla creada:',template.name);return template;}getMarketingStatistics(){const totalCampaigns = this.campaigns.length;const activeCampaigns = this.campaigns.filter((c)=> c.status === 'running').length;const totalLeads = this.leads.length;const qualifiedLeads = this.leads.filter((l)=> l.status === 'qualified').length;const totalContacts = this.contacts.length;const totalEmails = this.emails.length;const sentEmails = this.emails.filter((e)=> e.status === 'sent').length;const totalSMS = this.sms.length;const sentSMS = this.sms.filter((s)=> s.status === 'sent').length;const totalEvents = this.events.length;const upcomingEvents = this.events.filter((e)=> new Date(e.startDate)> new Date()).length;return{totalCampaigns,activeCampaigns,totalLeads,qualifiedLeads,totalContacts,totalEmails,sentEmails,totalSMS,sentSMS,totalEvents,upcomingEvents,};}showMarketingDashboard(){const dashboard = document.createElement('div');dashboard.id = 'marketing-dashboard';dashboard.innerHTML = ` <div class="marketing-dashboard-overlay"> <div class="marketing-dashboard-container"> <div class="marketing-dashboard-header"> <h3>üì¢ Dashboard de Marketing</h3> <div class="marketing-dashboard-actions"> <button class="btn btn-primary" onclick="axyraMarketingManagementSystem.showCreateCampaignDialog()">Nueva Campa√±a</button> <button class="btn btn-secondary" onclick="axyraMarketingManagementSystem.showCreateLeadDialog()">Nuevo Lead</button> <button class="btn btn-close" onclick="document.getElementById('marketing-dashboard').remove()">√ó</button> </div> </div> <div class="marketing-dashboard-body"> <div class="marketing-dashboard-stats"> ${this.renderMarketingStats()}</div> <div class="marketing-dashboard-content"> <div class="marketing-dashboard-tabs"> <button class="tab-btn active" data-tab="overview">Resumen</button> <button class="tab-btn" data-tab="campaigns">Campa√±as</button> <button class="tab-btn" data-tab="leads">Leads</button> <button class="tab-btn" data-tab="contacts">Contactos</button> <button class="tab-btn" data-tab="emails">Emails</button> </div> <div class="marketing-dashboard-tab-content"> <div class="tab-content active" id="overview-tab"> ${this.renderOverview()}</div> <div class="tab-content" id="campaigns-tab"> ${this.renderCampaignsList()}</div> <div class="tab-content" id="leads-tab"> ${this.renderLeadsList()}</div> <div class="tab-content" id="contacts-tab"> ${this.renderContactsList()}</div> <div class="tab-content" id="emails-tab"> ${this.renderEmailsList()}</div> </div> </div> </div> </div> </div> `;dashboard.style.cssText = ` position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:10000;display:flex;align-items:center;justify-content:center;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;`;document.body.appendChild(dashboard);const tabBtns = dashboard.querySelectorAll('.tab-btn');const tabContents = dashboard.querySelectorAll('.tab-content');tabBtns.forEach((btn)=>{btn.addEventListener('click',()=>{const tabId = btn.dataset.tab;tabBtns.forEach((b)=> b.classList.remove('active'));tabContents.forEach((c)=> c.classList.remove('active'));btn.classList.add('active');document.getElementById(`${tabId}-tab`).classList.add('active');});});}renderMarketingStats(){const stats = this.getMarketingStatistics();return ` <div class="stats-grid"> <div class="stat-card"> <div class="stat-value">${stats.totalCampaigns}</div> <div class="stat-label">Total Campa√±as</div> </div> <div class="stat-card"> <div class="stat-value">${stats.activeCampaigns}</div> <div class="stat-label">Campa√±as Activas</div> </div> <div class="stat-card"> <div class="stat-value">${stats.totalLeads}</div> <div class="stat-label">Total Leads</div> </div> <div class="stat-card"> <div class="stat-value">${stats.qualifiedLeads}</div> <div class="stat-label">Leads Calificados</div> </div> <div class="stat-card"> <div class="stat-value">${stats.totalContacts}</div> <div class="stat-label">Total Contactos</div> </div> <div class="stat-card"> <div class="stat-value">${stats.totalEmails}</div> <div class="stat-label">Total Emails</div> </div> <div class="stat-card"> <div class="stat-value">${stats.sentEmails}</div> <div class="stat-label">Emails Enviados</div> </div> <div class="stat-card"> <div class="stat-value">${stats.totalSMS}</div> <div class="stat-label">Total SMS</div> </div> <div class="stat-card"> <div class="stat-value">${stats.sentSMS}</div> <div class="stat-label">SMS Enviados</div> </div> <div class="stat-card"> <div class="stat-value">${stats.totalEvents}</div> <div class="stat-label">Total Eventos</div> </div> <div class="stat-card"> <div class="stat-value">${stats.upcomingEvents}</div> <div class="stat-label">Eventos Pr√≥ximos</div> </div> </div> `;}renderOverview(){const stats = this.getMarketingStatistics();return ` <div class="overview-grid"> <div class="overview-card"> <h4>Actividad de Marketing</h4> <div class="marketing-activity"> <div class="activity-item"> <span>Campa√±as Activas</span> <span>${stats.activeCampaigns}</span> </div> <div class="activity-item"> <span>Leads Calificados</span> <span>${stats.qualifiedLeads}</span> </div> <div class="activity-item"> <span>Emails Enviados</span> <span>${stats.sentEmails}</span> </div> </div> </div> <div class="overview-card"> <h4>Pr√≥ximos Eventos</h4> <div class="upcoming-events"> <div class="event-item"> <span>Eventos Pr√≥ximos</span> <span>${stats.upcomingEvents}</span> </div> </div> </div> </div> `;}renderCampaignsList(){const campaigns = this.campaigns.slice(-20);return campaigns .map((campaign)=> ` <div class="campaign-card"> <div class="campaign-header"> <h5>${campaign.name}</h5> <span class="campaign-status status-${campaign.status}">${campaign.status}</span> </div> <div class="campaign-info"> <p>${campaign.description}</p> <p>Tipo:${campaign.type}</p> <p>Presupuesto:$${campaign.budget.toLocaleString()}</p> <p>Fecha:${new Date(campaign.startDate).toLocaleDateString()}</p> </div> </div> `).join('');}renderLeadsList(){const leads = this.leads.slice(-20);return leads .map((lead)=> ` <div class="lead-card"> <div class="lead-header"> <h5>${lead.firstName}${lead.lastName}</h5> <span class="lead-status status-${lead.status}">${lead.status}</span> </div> <div class="lead-info"> <p>Email:${lead.email}</p> <p>Empresa:${lead.company}</p> <p>Fuente:${lead.source}</p> <p>Score:${lead.score}</p> </div> </div> `).join('');}renderContactsList(){const contacts = this.contacts.slice(-20);return contacts .map((contact)=> ` <div class="contact-card"> <div class="contact-header"> <h5>${contact.firstName}${contact.lastName}</h5> <span class="contact-status ${contact.isActive ? 'active':'inactive'}">${contact.isActive ? 'Activo':'Inactivo'}</span> </div> <div class="contact-info"> <p>Email:${contact.email}</p> <p>Tel√©fono:${contact.phone}</p> <p>Empresa:${contact.company}</p> </div> </div> `).join('');}renderEmailsList(){const emails = this.emails.slice(-20);return emails .map((email)=> ` <div class="email-card"> <div class="email-header"> <h5>${email.subject}</h5> <span class="email-status status-${email.status}">${email.status}</span> </div> <div class="email-info"> <p>Destinatarios:${email.recipientIds.length}</p> <p>Fecha:${new Date(email.createdAt).toLocaleDateString()}</p> <p>Tasa de Apertura:${email.openRate}%</p> <p>Tasa de Clics:${email.clickRate}%</p> </div> </div> `).join('');}showCreateCampaignDialog(){const name = prompt('Nombre de la campa√±a:');if(name){const description = prompt('Descripci√≥n de la campa√±a:');const type = prompt('Tipo de campa√±a(email,sms,social_media):');const budget = parseFloat(prompt('Presupuesto de la campa√±a:'));this.createCampaign({name,description,type,budget});}}showCreateLeadDialog(){const firstName = prompt('Nombre del lead:');if(firstName){const lastName = prompt('Apellido del lead:');const email = prompt('Email del lead:');const company = prompt('Empresa del lead:');this.createLead({firstName,lastName,email,company});}}getCurrentUser(){if(window.obtenerUsuarioActual){const user = window.obtenerUsuarioActual();return user ? user.id:'anonymous';}return 'anonymous';}}let axyraMarketingManagementSystem;document.addEventListener('DOMContentLoaded',()=>{axyraMarketingManagementSystem = new AxyraMarketingManagementSystem();window.axyraMarketingManagementSystem = axyraMarketingManagementSystem;});window.AxyraMarketingManagementSystem = AxyraMarketingManagementSystem;