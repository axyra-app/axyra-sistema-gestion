console.log('ðŸ’° Inicializando mÃ³dulo de nÃ³mina...');class AxyraNominaModule{constructor(){this.nominas = [];this.empleados = [];this.configuracion ={salarioMinimo:1160000,porcentajeSalud:0.04,porcentajePension:0.04,porcentajeRiesgo:0.00522,porcentajeSena:0.02,porcentajeICBF:0.03,porcentajeCaja:0.04,};this.init();}init(){console.log('âœ… MÃ³dulo de nÃ³mina inicializado');this.cargarNominas();this.cargarEmpleados();this.setupEventListeners();}cargarNominas(){try{const nominasGuardadas = localStorage.getItem('axyra_nomina');if(nominasGuardadas){this.nominas = JSON.parse(nominasGuardadas);console.log(`ðŸ“‹ Cargadas ${this.nominas.length}nÃ³minas`);}else{console.log('ðŸ“‹ No hay nÃ³minas guardadas');this.nominas = [];}}catch(error){console.error('âŒ Error cargando nÃ³minas:',error);this.nominas = [];}}cargarEmpleados(){try{const empleadosGuardados = localStorage.getItem('axyra_empleados');if(empleadosGuardados){this.empleados = JSON.parse(empleadosGuardados);console.log(`ðŸ‘¥ Cargados ${this.empleados.length}empleados para nÃ³mina`);}else{console.log('ðŸ‘¥ No hay empleados para nÃ³mina');this.empleados = [];}}catch(error){console.error('âŒ Error cargando empleados:',error);this.empleados = [];}}setupEventListeners(){console.log('ðŸ”— Event listeners de nÃ³mina configurados');}calcularNominaEmpleado(empleado,periodo){const salarioBase = empleado.salario || this.configuracion.salarioMinimo;const salud = salarioBase * this.configuracion.porcentajeSalud;const pension = salarioBase * this.configuracion.porcentajePension;const arl = salarioBase * this.configuracion.porcentajeRiesgo;const sena = salarioBase * this.configuracion.porcentajeSena;const icbf = salarioBase * this.configuracion.porcentajeICBF;const caja = salarioBase * this.configuracion.porcentajeCaja;const totalDescuentos = salud + pension + arl;const totalParafiscales = sena + icbf + caja;const netoAPagar = salarioBase - totalDescuentos;const costoTotal = salarioBase + totalParafiscales;return{empleado:empleado,periodo:periodo,salarioBase:salarioBase,descuentos:{salud:salud,pension:pension,arl:arl,total:totalDescuentos,},parafiscales:{sena:sena,icbf:icbf,caja:caja,total:totalParafiscales,},netoAPagar:netoAPagar,costoTotal:costoTotal,};}generarNomina(periodo,empleadosIds = null){const empleadosAProcesar = empleadosIds ? this.empleados.filter((emp)=> empleadosIds.includes(emp.id)):this.empleados.filter((emp)=> emp.estado === 'activo');const calculosNomina = empleadosAProcesar.map((empleado)=> this.calcularNominaEmpleado(empleado,periodo));const nomina ={id:'nom_' + Date.now(),periodo:periodo,fechaGeneracion:new Date().toISOString(),empleados:calculosNomina,resumen:this.calcularResumenNomina(calculosNomina),};this.nominas.push(nomina);this.guardarNominas();console.log('âœ… NÃ³mina generada:',nomina.id);return nomina;}calcularResumenNomina(calculosNomina){const totalSalarios = calculosNomina.reduce((sum,calc)=> sum + calc.salarioBase,0);const totalDescuentos = calculosNomina.reduce((sum,calc)=> sum + calc.descuentos.total,0);const totalParafiscales = calculosNomina.reduce((sum,calc)=> sum + calc.parafiscales.total,0);const totalNeto = calculosNomina.reduce((sum,calc)=> sum + calc.netoAPagar,0);const costoTotal = calculosNomina.reduce((sum,calc)=> sum + calc.costoTotal,0);return{totalEmpleados:calculosNomina.length,totalSalarios:totalSalarios,totalDescuentos:totalDescuentos,totalParafiscales:totalParafiscales,totalNeto:totalNeto,costoTotal:costoTotal,};}guardarNominas(){try{localStorage.setItem('axyra_nomina',JSON.stringify(this.nominas));console.log('ðŸ’¾ NÃ³minas guardadas en localStorage');}catch(error){console.error('âŒ Error guardando nÃ³minas:',error);}}obtenerNominasPorPeriodo(periodo){return this.nominas.filter((nomina)=> nomina.periodo === periodo);}obtenerEstadisticas(){const totalNominas = this.nominas.length;const ultimaNomina = this.nominas[this.nominas.length - 1];const totalEmpleados = this.empleados.length;const empleadosActivos = this.empleados.filter((emp)=> emp.estado === 'activo').length;return{totalNominas,ultimaNomina,totalEmpleados,empleadosActivos,costoPromedio:ultimaNomina ? ultimaNomina.resumen.costoTotal:0,};}}document.addEventListener('DOMContentLoaded',()=>{if(typeof window.axyraNominaModule === 'undefined'){window.axyraNominaModule = new AxyraNominaModule();console.log('ðŸŽ¯ MÃ³dulo de nÃ³mina disponible globalmente');}});window.AxyraNominaModule = AxyraNominaModule;